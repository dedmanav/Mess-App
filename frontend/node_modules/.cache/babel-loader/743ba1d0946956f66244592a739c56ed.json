{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\acer\\\\Desktop\\\\MessProject\\\\Mess-App\\\\frontend\\\\src\\\\components\\\\pages\\\\SignUp.js\";\nimport React from 'react';\nimport '../../App.css';\nimport { useEffect } from 'react';\nimport jwt_decode from 'jwt-decode';\nimport bcrypt from 'bcrypt';\nimport jwt from 'jasonwebtoken';\nfunction SignUp() {\n  // const [user,setUser] = useState({});\n\n  function handleCallbackResponse(response) {\n    console.log(\"Encoded JWT ID token :\" + response.credential);\n    var userObject = jwt_decode(response.credential);\n    console.log(userObject);\n    if (userObject.email_verified) {\n      db.collection('users').find({\n        email: userObject.email\n      }).toArray((err, result) => {\n        if (err) throw err;\n        if (result.length < 1) {\n          db.collection('users').insert([{\n            name: userObject.name,\n            email: userObject.email,\n            password: bcrypt.hashSync(userObject.at_hash, 8)\n          }]);\n          db.collection('users').find({\n            email: userObject.email\n          }).toArray((e, r) => {\n            if (e) throw e;\n            var tkn = jwt.sign({\n              id: result[0]._id\n            }, secret);\n            res.send({\n              auth: true,\n              token: tkn\n            });\n          });\n        } else {\n          var token = jwt.sign({\n            id: result[0]._id\n          }, secret);\n          res.send({\n            auth: true,\n            token: token\n          });\n        }\n      });\n    }\n    // setUser(userObject);\n  }\n\n  useEffect(() => {\n    /*global google*/\n    google.accounts.id.initialize({\n      client_id: \"802699845079-f88eqoj2naua7selgj0g5dg8vfjm3or5.apps.googleusercontent.com\",\n      callback: handleCallbackResponse\n      // hosted_domain:'itbhu.ac.in'\n    });\n\n    google.accounts.id.renderButton(document.getElementById(\"signInDiv\"), {\n      theme: \"outline\",\n      size: \"large\"\n    });\n    google.accounts.id.prompt();\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"signInDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, \"googleLogin\");\n}\nexport default SignUp;","map":{"version":3,"names":["React","useEffect","jwt_decode","bcrypt","jwt","SignUp","handleCallbackResponse","response","console","log","credential","userObject","email_verified","db","collection","find","email","toArray","err","result","length","insert","name","password","hashSync","at_hash","e","r","tkn","sign","id","_id","secret","res","send","auth","token","google","accounts","initialize","client_id","callback","renderButton","document","getElementById","theme","size","prompt","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["C:/Users/acer/Desktop/MessProject/Mess-App/frontend/src/components/pages/SignUp.js"],"sourcesContent":["import React from 'react';\r\nimport '../../App.css';\r\nimport { useEffect } from 'react';\r\nimport jwt_decode from 'jwt-decode';\r\nimport bcrypt from 'bcrypt'\r\nimport jwt from 'jasonwebtoken'\r\n\r\n\r\n\r\n function SignUp() {\r\n\r\n    // const [user,setUser] = useState({});\r\n\r\nfunction handleCallbackResponse(response){\r\n    console.log(\"Encoded JWT ID token :\" + response.credential);\r\n    var userObject = jwt_decode(response.credential);\r\n    console.log(userObject);\r\n    if(userObject.email_verified){\r\n        db.collection('users').find({email:userObject.email}).toArray((err,result)=>{\r\n          if(err) throw(err);\r\n          if(result.length<1){\r\n            db.collection('users').insert([{\r\n                name:userObject.name,\r\n                email:userObject.email,\r\n                password: bcrypt.hashSync(userObject.at_hash,8)\r\n            }])\r\n            db.collection('users').find({email:userObject.email}).toArray((e,r)=>{\r\n              if(e) throw e;\r\n              var tkn = jwt.sign({id:result[0]._id},secret);\r\n              res.send({\r\n                auth:true,\r\n                token:tkn\r\n              })\r\n            })\r\n          }else{\r\n            var token = jwt.sign({id:result[0]._id},secret);\r\n            res.send({\r\n              auth:true,\r\n              token:token\r\n            })\r\n          }\r\n        })\r\n    }\r\n    // setUser(userObject);\r\n}\r\n\r\nuseEffect(()=>{\r\n  /*global google*/\r\n  google.accounts.id.initialize({\r\n    client_id:\"802699845079-f88eqoj2naua7selgj0g5dg8vfjm3or5.apps.googleusercontent.com\",\r\n    callback: handleCallbackResponse\r\n    // hosted_domain:'itbhu.ac.in'\r\n  });\r\n  google.accounts.id.renderButton(\r\n    document.getElementById(\"signInDiv\"),\r\n    {theme: \"outline\",size:\"large\"}\r\n  );\r\n  google.accounts.id.prompt();\r\n},[]);\r\n\r\n  return (\r\n    <div id='signInDiv'>googleLogin</div>\r\n  )\r\n}\r\nexport default SignUp;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}